<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>MANTIS: lib/include/CryptoPrimitives.h File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.3-20050530 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a></div>
<div class="nav">
<a class="el" href="dir_000000.html">lib</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_000001.html">include</a></div>
<h1>CryptoPrimitives.h File Reference</h1>Provides fast bit shift operations for the ATMEL chip. <a href="#_details">More...</a>
<p>

<p>
<a href="CryptoPrimitives_8h-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="CryptoPrimitives_8h.html#a0">rol32</a>(a, n)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Performs a leftward rotation on 32 bits of data, 1 bit at a time.  <a href="#a0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="CryptoPrimitives_8h.html#a1">ror32</a>(a, n)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Performs a rightward rotation on 32 bits of data, 1 bit at a time.  <a href="#a1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="CryptoPrimitives_8h.html#a2">c2l</a>(c, l)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Copies a 4 byte char buf to a long and moves the ptr.  <a href="#a2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="CryptoPrimitives_8h.html#a3">l2c</a>(l, c)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Copies a long to a 4 byte char buf to a long and doesn't advances the char ptr.  <a href="#a3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="CryptoPrimitives_8h.html#a4">brol1</a>(a)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Performs a 1 byte block roll to the left equiv to <a class="el" href="CryptoPrimitives_8h.html#a0">rol32(a, 8)</a>.  <a href="#a4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="CryptoPrimitives_8h.html#a5">brol2</a>(a)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Performs a 2 byte block roll to the left equiv to <a class="el" href="CryptoPrimitives_8h.html#a0">rol32(a, 16)</a>.  <a href="#a5"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="CryptoPrimitives_8h.html#a6">brol3</a>(a)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Performs a 3 byte block roll to the left equiv to <a class="el" href="CryptoPrimitives_8h.html#a0">rol32(a, 24)</a>.  <a href="#a6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="CryptoPrimitives_8h.html#a7">bror1</a>(a)&nbsp;&nbsp;&nbsp;(brol3(a))</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="CryptoPrimitives_8h.html#a8">bror2</a>(a)&nbsp;&nbsp;&nbsp;(brol2(a))</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="CryptoPrimitives_8h.html#a9">bror3</a>(a)&nbsp;&nbsp;&nbsp;(brol1(a))</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="CryptoPrimitives_8h.html#a10">fastrol32</a>(a, n)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Fast rol to the left using the above primitives.  <a href="#a10"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="CryptoPrimitives_8h.html#a11">fastror32</a>(a, n)&nbsp;&nbsp;&nbsp;fastrol32(a, (32-n))</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Can be improved to eliminate the subtraction.  <a href="#a11"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="CryptoPrimitives_8h.html#a12">c2sM</a>(c, s)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Convert a 2 byte char array to an unsigned short.  <a href="#a12"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="CryptoPrimitives_8h.html#a13">s2cM</a>(s, c)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Convert a unsigned short to a 2 byte char array.  <a href="#a13"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Provides fast bit shift operations for the ATMEL chip. 
<p>
<dl compact><dt><b>Author:</b></dt><dd>Naveen Sastry <p>
Modified: Jing Deng </dd></dl>
<dl compact><dt><b>Date:</b></dt><dd>12/05/2003</dd></dl>

<p>
Definition in file <a class="el" href="CryptoPrimitives_8h-source.html">CryptoPrimitives.h</a>.<hr><h2>Define Documentation</h2>
<a class="anchor" name="a4"></a><!-- doxytag: member="CryptoPrimitives.h::brol1" ref="a4" args="(a)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define brol1          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">a&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><div class="fragment"><pre class="fragment">({                                    \
  uint8_t  brol1tmp;                                   \
  __asm__  (   <span class="stringliteral">"mov %1, %D0"</span> <span class="stringliteral">"\n\t"</span>                    \
               <span class="stringliteral">"mov %D0, %C0"</span> <span class="stringliteral">"\n\t"</span>                   \
               <span class="stringliteral">"mov %C0, %B0"</span> <span class="stringliteral">"\n\t"</span>                   \
               <span class="stringliteral">"mov %B0, %A0"</span> <span class="stringliteral">"\n\t"</span>                   \
               <span class="stringliteral">"mov %A0, %1"</span> <span class="stringliteral">"\n\t"</span>                    \
               : <span class="stringliteral">"=r"</span>(a), <span class="stringliteral">"=r"</span> (brol1tmp)              \
               : <span class="stringliteral">"0"</span> (a)                               \
               );                                      \
});
</pre></div>Performs a 1 byte block roll to the left equiv to <a class="el" href="CryptoPrimitives_8h.html#a0">rol32(a, 8)</a>. 
<p>
5 cycles
<p>
Definition at line <a class="el" href="CryptoPrimitives_8h-source.html#l00134">134</a> of file <a class="el" href="CryptoPrimitives_8h-source.html">CryptoPrimitives.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a5"></a><!-- doxytag: member="CryptoPrimitives.h::brol2" ref="a5" args="(a)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define brol2          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">a&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><div class="fragment"><pre class="fragment">({                                    \
  uint8_t  brol2tmp;                                   \
  __asm__  (   <span class="stringliteral">"mov %1, %A0"</span>   <span class="stringliteral">"\n\t"</span>                  \
               <span class="stringliteral">"mov %A0, %C0"</span>  <span class="stringliteral">"\n\t"</span>                  \
               <span class="stringliteral">"mov %C0, %1"</span>   <span class="stringliteral">"\n\t"</span>                  \
               <span class="stringliteral">"mov %1, %B0"</span>   <span class="stringliteral">"\n\t"</span>                  \
               <span class="stringliteral">"mov %B0, %D0"</span>  <span class="stringliteral">"\n\t"</span>                  \
               <span class="stringliteral">"mov %D0, %1"</span>   <span class="stringliteral">"\n\t"</span>                  \
               : <span class="stringliteral">"=r"</span>(a), <span class="stringliteral">"=r"</span> (brol2tmp)              \
               : <span class="stringliteral">"0"</span> (a)                               \
               );                                      \
});
</pre></div>Performs a 2 byte block roll to the left equiv to <a class="el" href="CryptoPrimitives_8h.html#a0">rol32(a, 16)</a>. 
<p>
6 cycles
<p>
Definition at line <a class="el" href="CryptoPrimitives_8h-source.html#l00151">151</a> of file <a class="el" href="CryptoPrimitives_8h-source.html">CryptoPrimitives.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a6"></a><!-- doxytag: member="CryptoPrimitives.h::brol3" ref="a6" args="(a)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define brol3          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">a&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><div class="fragment"><pre class="fragment">({                                    \
  uint8_t  brol3tmp;                                   \
  __asm__  (   <span class="stringliteral">"mov %1, %A0"</span> <span class="stringliteral">"\n\t"</span>                    \
               <span class="stringliteral">"mov %A0, %B0"</span> <span class="stringliteral">"\n\t"</span>                   \
               <span class="stringliteral">"mov %B0, %C0"</span> <span class="stringliteral">"\n\t"</span>                   \
               <span class="stringliteral">"mov %C0, %D0"</span> <span class="stringliteral">"\n\t"</span>                   \
               <span class="stringliteral">"mov %D0, %1"</span> <span class="stringliteral">"\n\t"</span>                    \
               : <span class="stringliteral">"=r"</span>(a), <span class="stringliteral">"=r"</span> (brol3tmp)              \
               : <span class="stringliteral">"0"</span> (a)                               \
               );                                      \
});
</pre></div>Performs a 3 byte block roll to the left equiv to <a class="el" href="CryptoPrimitives_8h.html#a0">rol32(a, 24)</a>. 
<p>
5 cycles
<p>
Definition at line <a class="el" href="CryptoPrimitives_8h-source.html#l00169">169</a> of file <a class="el" href="CryptoPrimitives_8h-source.html">CryptoPrimitives.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a7"></a><!-- doxytag: member="CryptoPrimitives.h::bror1" ref="a7" args="(a)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define bror1          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">a&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(brol3(a))</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="CryptoPrimitives_8h-source.html#l00181">181</a> of file <a class="el" href="CryptoPrimitives_8h-source.html">CryptoPrimitives.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a8"></a><!-- doxytag: member="CryptoPrimitives.h::bror2" ref="a8" args="(a)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define bror2          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">a&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(brol2(a))</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="CryptoPrimitives_8h-source.html#l00182">182</a> of file <a class="el" href="CryptoPrimitives_8h-source.html">CryptoPrimitives.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a9"></a><!-- doxytag: member="CryptoPrimitives.h::bror3" ref="a9" args="(a)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define bror3          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">a&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(brol1(a))</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="CryptoPrimitives_8h-source.html#l00183">183</a> of file <a class="el" href="CryptoPrimitives_8h-source.html">CryptoPrimitives.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a2"></a><!-- doxytag: member="CryptoPrimitives.h::c2l" ref="a2" args="(c, l)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define c2l          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">c,         <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>l&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><div class="fragment"><pre class="fragment">({                                    \
  __asm__ (    <span class="stringliteral">"mov r30, %A1"</span> <span class="stringliteral">"\n\t"</span>                   \
               <span class="stringliteral">"mov r31, %B1"</span> <span class="stringliteral">"\n\t"</span>                   \
               <span class="stringliteral">"ld %A0, Z+"</span> <span class="stringliteral">"\n\t"</span>                     \
               <span class="stringliteral">"ld %B0, Z+"</span> <span class="stringliteral">"\n\t"</span>                     \
               <span class="stringliteral">"ld %C0, Z+"</span> <span class="stringliteral">"\n\t"</span>                     \
               <span class="stringliteral">"ld %D0, Z "</span> <span class="stringliteral">"\n\t"</span>                     \
               : <span class="stringliteral">"=r"</span> (l)                              \
               : <span class="stringliteral">"r"</span> (c)                               \
               : <span class="stringliteral">"r30"</span>, <span class="stringliteral">"r31"</span>);                        \
});
</pre></div>Copies a 4 byte char buf to a long and moves the ptr. 
<p>
10 cycles
<p>
Definition at line <a class="el" href="CryptoPrimitives_8h-source.html#l00100">100</a> of file <a class="el" href="CryptoPrimitives_8h-source.html">CryptoPrimitives.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a12"></a><!-- doxytag: member="CryptoPrimitives.h::c2sM" ref="a12" args="(c, s)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define c2sM          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">c,         <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>s&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><div class="fragment"><pre class="fragment">(s = ((<span class="keywordtype">unsigned</span> short)(*((c))))  &lt;&lt;8L ,             \
                          s|= ((<span class="keywordtype">unsigned</span> short)(*((c+1)))))
</pre></div>Convert a 2 byte char array to an unsigned short. 
<p>
[assumes MOST significant byte is first]
<p>
Definition at line <a class="el" href="CryptoPrimitives_8h-source.html#l00219">219</a> of file <a class="el" href="CryptoPrimitives_8h-source.html">CryptoPrimitives.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a10"></a><!-- doxytag: member="CryptoPrimitives.h::fastrol32" ref="a10" args="(a, n)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define fastrol32          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">a,         <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>n&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><div class="fragment"><pre class="fragment">({                                                 \
  <span class="keywordflow">switch</span> ((n)) {                                                           \
  <span class="keywordflow">case</span> 0: <span class="keywordflow">break</span>;                                                           \
  <span class="keywordflow">case</span> 1: <span class="keywordflow">case</span> 2: <span class="keywordflow">case</span> 3: <span class="keywordflow">case</span> 4: <span class="keywordflow">case</span> 5: <a class="code" href="CryptoPrimitives_8h.html#a0">rol32</a> (a, (n)); <span class="keywordflow">break</span>;           \
  <span class="keywordflow">case</span> 6: <span class="keywordflow">case</span> 7: <a class="code" href="CryptoPrimitives_8h.html#a4">brol1</a>(a); <a class="code" href="CryptoPrimitives_8h.html#a1">ror32</a>(a, 8-(n)); <span class="keywordflow">break</span>;                        \
  <span class="keywordflow">case</span> 8: <span class="keywordflow">case</span> 9: <span class="keywordflow">case</span> 10: <span class="keywordflow">case</span> 11: <span class="keywordflow">case</span> 12:  <a class="code" href="CryptoPrimitives_8h.html#a4">brol1</a>(a); <a class="code" href="CryptoPrimitives_8h.html#a0">rol32</a>(a, (n)-8 );  \
          <span class="keywordflow">break</span>;                                                           \
  <span class="keywordflow">case</span> 13: <span class="keywordflow">case</span> 14: <span class="keywordflow">case</span> 15: <span class="keywordflow">case</span> 16: <a class="code" href="CryptoPrimitives_8h.html#a5">brol2</a>(a); <a class="code" href="CryptoPrimitives_8h.html#a1">ror32</a>(a, 16-(n)); <span class="keywordflow">break</span>;   \
  <span class="keywordflow">case</span> 17: <span class="keywordflow">case</span> 18: <span class="keywordflow">case</span> 19: <span class="keywordflow">case</span> 20: <a class="code" href="CryptoPrimitives_8h.html#a5">brol2</a>(a); <a class="code" href="CryptoPrimitives_8h.html#a0">rol32</a>(a, (n) -16); <span class="keywordflow">break</span>;  \
  <span class="keywordflow">case</span> 21: <span class="keywordflow">case</span> 22: <span class="keywordflow">case</span> 23: <span class="keywordflow">case</span> 24: <a class="code" href="CryptoPrimitives_8h.html#a6">brol3</a>(a); <a class="code" href="CryptoPrimitives_8h.html#a1">ror32</a>(a, 24-(n)); <span class="keywordflow">break</span>;   \
  <span class="keywordflow">case</span> 25: <span class="keywordflow">case</span> 26: <span class="keywordflow">case</span> 27: <span class="keywordflow">case</span> 28: <a class="code" href="CryptoPrimitives_8h.html#a6">brol3</a>(a); <a class="code" href="CryptoPrimitives_8h.html#a0">rol32</a>(a, (n) -24); <span class="keywordflow">break</span>;  \
  <span class="keywordflow">case</span> 29: <span class="keywordflow">case</span> 30: <span class="keywordflow">case</span> 31: <a class="code" href="CryptoPrimitives_8h.html#a1">ror32</a>(a, 32 - (n));                           \
  }                                                                        \
});
</pre></div>Fast rol to the left using the above primitives. 
<p>
(switch): 16 cycles (brol.) : 5 cycles sub: : 1 cycle rol32: : 2 + (9n), 0 &lt;= n &lt;= 4 =============================== BEST : 16 / 21 cycles (byte boundaries) AVG : 42 cycles WORST : 60 cycles
<p>
Definition at line <a class="el" href="CryptoPrimitives_8h-source.html#l00196">196</a> of file <a class="el" href="CryptoPrimitives_8h-source.html">CryptoPrimitives.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a11"></a><!-- doxytag: member="CryptoPrimitives.h::fastror32" ref="a11" args="(a, n)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define fastror32          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">a,         <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>n&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;fastrol32(a, (32-n))</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Can be improved to eliminate the subtraction. 
<p>

<p>
Definition at line <a class="el" href="CryptoPrimitives_8h-source.html#l00212">212</a> of file <a class="el" href="CryptoPrimitives_8h-source.html">CryptoPrimitives.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3"></a><!-- doxytag: member="CryptoPrimitives.h::l2c" ref="a3" args="(l, c)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define l2c          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">l,         <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>c&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><div class="fragment"><pre class="fragment">({                                    \
  __asm__ <span class="keyword">volatile</span> (    <span class="stringliteral">"mov r30, %A0"</span> <span class="stringliteral">"\n\t"</span>          \
               <span class="stringliteral">"mov r31, %B0"</span> <span class="stringliteral">"\n\t"</span>                   \
               <span class="stringliteral">"st Z+, %A1"</span> <span class="stringliteral">"\n\t"</span>                     \
               <span class="stringliteral">"st Z+, %B1"</span> <span class="stringliteral">"\n\t"</span>                     \
               <span class="stringliteral">"st Z+, %C1"</span> <span class="stringliteral">"\n\t"</span>                     \
               <span class="stringliteral">"st Z,  %D1"</span> <span class="stringliteral">"\n\t"</span>                     \
               :                                       \
               : <span class="stringliteral">"r"</span> (c), <span class="stringliteral">"r"</span> (l)                      \
               : <span class="stringliteral">"r30"</span>, <span class="stringliteral">"r31"</span>);                        \
});
</pre></div>Copies a long to a 4 byte char buf to a long and doesn't advances the char ptr. 
<p>
10 cycles
<p>
Definition at line <a class="el" href="CryptoPrimitives_8h-source.html#l00117">117</a> of file <a class="el" href="CryptoPrimitives_8h-source.html">CryptoPrimitives.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a0"></a><!-- doxytag: member="CryptoPrimitives.h::rol32" ref="a0" args="(a, n)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define rol32          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">a,         <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>n&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><div class="fragment"><pre class="fragment">({                                      \
        <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> num = (<span class="keywordtype">unsigned</span> long)(a);         \
        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> nsh = (<span class="keywordtype">unsigned</span> char)(n);         \
        __asm__ __volatile__ (                          \
                <span class="stringliteral">"dec %0"</span> <span class="stringliteral">"\n\t"</span>                         \
                <span class="stringliteral">"brmi L_%="</span> <span class="stringliteral">"\n\t"</span>                      \
        <span class="stringliteral">"L1_%=:"</span> <span class="stringliteral">"\n\t"</span>                                 \
                <span class="stringliteral">"clc"</span> <span class="stringliteral">"\n\t"</span>                            \
                <span class="stringliteral">"sbrc %D1, 7"</span> <span class="stringliteral">"\n\t"</span>                    \
                <span class="stringliteral">"sec"</span> <span class="stringliteral">"\n\t"</span>                            \
                <span class="stringliteral">"rol %A1"</span> <span class="stringliteral">"\n\t"</span>                        \
                <span class="stringliteral">"rol %B1"</span> <span class="stringliteral">"\n\t"</span>                        \
                <span class="stringliteral">"rol %C1"</span> <span class="stringliteral">"\n\t"</span>                        \
                <span class="stringliteral">"rol %D1"</span> <span class="stringliteral">"\n\t"</span>                        \
                <span class="stringliteral">"dec %0"</span> <span class="stringliteral">"\n\t"</span>                         \
                <span class="stringliteral">"brpl L1_%="</span> <span class="stringliteral">"\n\t"</span>                     \
        <span class="stringliteral">"L_%=:"</span> <span class="stringliteral">"\n\t"</span>                                  \
                : <span class="stringliteral">"=r"</span> (nsh), <span class="stringliteral">"=r"</span> (num)                \
                : <span class="stringliteral">"0"</span> (nsh), <span class="stringliteral">"1"</span> (num)                  \
        );                                              \
        a = num;                                        \
})
</pre></div>Performs a leftward rotation on 32 bits of data, 1 bit at a time. 
<p>
(2 + (n * 9)) cycles
<p>
Definition at line <a class="el" href="CryptoPrimitives_8h-source.html#l00044">44</a> of file <a class="el" href="CryptoPrimitives_8h-source.html">CryptoPrimitives.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1"></a><!-- doxytag: member="CryptoPrimitives.h::ror32" ref="a1" args="(a, n)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define ror32          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">a,         <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>n&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><div class="fragment"><pre class="fragment">({                                      \
        <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> num = (<span class="keywordtype">unsigned</span> long)(a);         \
        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> nsh = (<span class="keywordtype">unsigned</span> char)(n);         \
        __asm__ (                                       \
                <span class="stringliteral">"dec %0"</span> <span class="stringliteral">"\n\t"</span>                         \
                <span class="stringliteral">"brmi L_%="</span> <span class="stringliteral">"\n\t"</span>                      \
        <span class="stringliteral">"L1_%=:"</span> <span class="stringliteral">"\n\t"</span>                                 \
                <span class="stringliteral">"clc"</span> <span class="stringliteral">"\n\t"</span>                            \
                <span class="stringliteral">"sbrc %A1, 0"</span> <span class="stringliteral">"\n\t"</span>                    \
                <span class="stringliteral">"sec"</span> <span class="stringliteral">"\n\t"</span>                            \
                <span class="stringliteral">"ror %D1"</span> <span class="stringliteral">"\n\t"</span>                        \
                <span class="stringliteral">"ror %C1"</span> <span class="stringliteral">"\n\t"</span>                        \
                <span class="stringliteral">"ror %B1"</span> <span class="stringliteral">"\n\t"</span>                        \
                <span class="stringliteral">"ror %A1"</span> <span class="stringliteral">"\n\t"</span>                        \
                <span class="stringliteral">"dec %0"</span> <span class="stringliteral">"\n\t"</span>                         \
                <span class="stringliteral">"brpl L1_%="</span> <span class="stringliteral">"\n\t"</span>                     \
        <span class="stringliteral">"L_%=:"</span> <span class="stringliteral">"\n\t"</span>                                  \
                : <span class="stringliteral">"=r"</span> (nsh), <span class="stringliteral">"=r"</span> (num)                \
                : <span class="stringliteral">"0"</span> (nsh), <span class="stringliteral">"1"</span> (num)                  \
        );                                              \
        a = num;                                        \
})
</pre></div>Performs a rightward rotation on 32 bits of data, 1 bit at a time. 
<p>
(2 + (n * 9)) cycles
<p>
Definition at line <a class="el" href="CryptoPrimitives_8h-source.html#l00073">73</a> of file <a class="el" href="CryptoPrimitives_8h-source.html">CryptoPrimitives.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a13"></a><!-- doxytag: member="CryptoPrimitives.h::s2cM" ref="a13" args="(s, c)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define s2cM          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">s,         <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>c&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><div class="fragment"><pre class="fragment">(*((c))   = (<span class="keywordtype">unsigned</span> short)(((s) &gt;&gt; 8L)&amp;0xff), \
                         *((c+1)) = (<span class="keywordtype">unsigned</span> short)(((s)      ) &amp;0xff))
</pre></div>Convert a unsigned short to a 2 byte char array. 
<p>
[assumes MOST significant byte is first]
<p>
Definition at line <a class="el" href="CryptoPrimitives_8h-source.html#l00226">226</a> of file <a class="el" href="CryptoPrimitives_8h-source.html">CryptoPrimitives.h</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Wed Jul 27 17:00:34 2005 for MANTIS by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.3-20050530 </small></address>
</body>
</html>
